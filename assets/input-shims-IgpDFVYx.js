import{O as A,W as k,X as P,Y as B,T as p,S as F,Z as H,$ as y,a0 as $,a1 as Y,a2 as U}from"./ionic-BTAHEwko.js";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const D=new WeakMap,T=(e,s,t,o=0,r=!1)=>{D.has(e)!==t&&(t?q(e,s,o,r):G(e,s))},W=e=>e===e.getRootNode().activeElement,q=(e,s,t,o=!1)=>{const r=s.parentNode,n=s.cloneNode(!1);n.classList.add("cloned-input"),n.tabIndex=-1,o&&(n.disabled=!0),r.appendChild(n),D.set(e,n);const a=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",s.style.transform=`translate3d(${a}px,${t}px,0) scale(0)`},G=(e,s)=>{const t=D.get(e);t&&(D.delete(e),t.remove()),e.style.pointerEvents="",s.style.transform=""},N=50,z=(e,s,t)=>{if(!t||!s)return()=>{};const o=a=>{W(s)&&T(e,s,a)},r=()=>T(e,s,!1),n=()=>o(!0),c=()=>o(!1);return P(t,"ionScrollStart",n),P(t,"ionScrollEnd",c),s.addEventListener("blur",r),()=>{B(t,"ionScrollStart",n),B(t,"ionScrollEnd",c),s.removeEventListener("blur",r)}},I="input, textarea, [no-blur], [contenteditable]",j=()=>{let e=!0,s=!1;const t=document,o=()=>{s=!0},r=()=>{e=!0},n=c=>{if(s){s=!1;return}const a=t.activeElement;if(!a||a.matches(I))return;const f=c.target;f!==a&&(f.matches(I)||f.closest(I)||(e=!1,setTimeout(()=>{e||a.blur()},50)))};return P(t,"ionScrollStart",o),t.addEventListener("focusin",r,!0),t.addEventListener("touchend",n,!1),()=>{B(t,"ionScrollStart",o,!0),t.removeEventListener("focusin",r,!0),t.removeEventListener("touchend",n,!1)}},X=.3,Z=(e,s,t,o)=>{var r;const n=(r=e.closest("ion-item,[ion-item]"))!==null&&r!==void 0?r:e;return J(n.getBoundingClientRect(),s.getBoundingClientRect(),t,o)},J=(e,s,t,o)=>{const r=e.top,n=e.bottom,c=s.top,a=Math.min(s.bottom,o-t),f=c+15,u=a-N-n,d=f-r,S=Math.round(u<0?-u:d>0?-d:0),v=Math.min(S,r-c),i=Math.abs(v)/X,b=Math.min(400,Math.max(150,i));return{scrollAmount:v,scrollDuration:b,scrollPadding:t,inputSafeY:-(r-f)+4}},R="$ionPaddingTimer",M=(e,s,t)=>{const o=e[R];o&&clearTimeout(o),s>0?e.style.setProperty("--keyboard-offset",`${s}px`):e[R]=setTimeout(()=>{e.style.setProperty("--keyboard-offset","0px"),t&&t()},120)},_=(e,s,t)=>{const o=()=>{s&&M(s,0,t)};e.addEventListener("focusout",o,{once:!0})};let g=0;const K="data-ionic-skip-scroll-assist",Q=(e,s,t,o,r,n,c,a=!1)=>{const f=n&&(c===void 0||c.mode===H.None);let l=!1;const u=y!==void 0?y.innerHeight:0,d=h=>{if(l===!1){l=!0;return}O(e,s,t,o,h.detail.keyboardHeight,f,a,u,!1)},S=()=>{l=!1,y===null||y===void 0||y.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)},v=async()=>{if(s.hasAttribute(K)){s.removeAttribute(K);return}O(e,s,t,o,r,f,a,u),y===null||y===void 0||y.addEventListener("ionKeyboardDidShow",d),e.addEventListener("focusout",S)};return e.addEventListener("focusin",v),()=>{e.removeEventListener("focusin",v),y===null||y===void 0||y.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)}},C=e=>{var s;if(document.activeElement===e)return;const t=e.getAttribute("id"),o=e.closest(`label[for="${t}"]`),r=(s=document.activeElement)===null||s===void 0?void 0:s.closest(`label[for="${t}"]`);o!==null&&o===r||(e.setAttribute(K,"true"),e.focus())},O=async(e,s,t,o,r,n,c=!1,a=0,f=!0)=>{if(!t&&!o)return;const l=Z(e,t||o,r,a);if(t&&Math.abs(l.scrollAmount)<4){C(s),n&&t!==null&&(M(t,g),_(s,t,()=>g=0));return}if(T(e,s,!0,l.inputSafeY,c),C(s),$(()=>e.click()),n&&t&&(g=l.scrollPadding,M(t,g)),typeof window<"u"){let u;const d=async()=>{u!==void 0&&clearTimeout(u),window.removeEventListener("ionKeyboardDidShow",S),window.removeEventListener("ionKeyboardDidShow",d),t&&await U(t,0,l.scrollAmount,l.scrollDuration),T(e,s,!1,l.inputSafeY),C(s),n&&_(s,t,()=>g=0)},S=()=>{window.removeEventListener("ionKeyboardDidShow",S),window.addEventListener("ionKeyboardDidShow",d)};if(t){const v=await Y(t),h=v.scrollHeight-v.clientHeight;if(f&&l.scrollAmount>h-v.scrollTop){s.type==="password"?(l.scrollAmount+=N,window.addEventListener("ionKeyboardDidShow",S)):window.addEventListener("ionKeyboardDidShow",d),u=setTimeout(d,1e3);return}}d()}},V=!0,te=async(e,s)=>{if(A===void 0)return;const t=s==="ios",o=s==="android",r=e.getNumber("keyboardHeight",290),n=e.getBoolean("scrollAssist",!0),c=e.getBoolean("hideCaretOnScroll",t),a=e.getBoolean("inputBlurring",!1),f=e.getBoolean("scrollPadding",!0),l=Array.from(A.querySelectorAll("ion-input, ion-textarea")),u=new WeakMap,d=new WeakMap,S=await k.getResizeMode(),v=async i=>{await new Promise(w=>p(i,w));const b=i.shadowRoot||i,L=b.querySelector("input")||b.querySelector("textarea"),m=F(i),x=m?null:i.closest("ion-footer");if(!L)return;if(m&&c&&!u.has(i)){const w=z(i,L,m);u.set(i,w)}if(!(L.type==="date"||L.type==="datetime-local")&&(m||x)&&n&&!d.has(i)){const w=Q(i,L,m,x,r,f,S,o);d.set(i,w)}},h=i=>{if(c){const b=u.get(i);b&&b(),u.delete(i)}if(n){const b=d.get(i);b&&b(),d.delete(i)}};a&&V&&j();for(const i of l)v(i);A.addEventListener("ionInputDidLoad",i=>{v(i.detail)}),A.addEventListener("ionInputDidUnload",i=>{h(i.detail)})};export{te as startInputShims};
